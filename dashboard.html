<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Dashboard CDA</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { background-color:#f5f6fa; }
    .sidebar {
      width: 240px;
      position: fixed;
      top: 0; left: 0; bottom: 0;
      background: #343a40;
      color: #fff;
      padding-top: 1rem;
    }
    .sidebar a {
      color: #adb5bd;
      display: block;
      padding: .75rem 1rem;
      text-decoration: none;
    }
    .sidebar a:hover, .sidebar a.active {
      background: #495057;
      color: #fff;
    }
    .content {
      margin-left: 240px;
      padding: 2rem;
    }
    .table thead {background-color:#343a40;color:#fff;}
  </style>
</head>
<body>

  <!-- Sidebar -->
  <nav class="sidebar">
    <h4 class="text-center text-white mb-4">CDA Dashboard</h4>
    <a href="#" class="active" data-section="usuarios">Usuarios</a>
    <a href="#" data-section="vehiculos">Vehículos</a>
    <a href="#" data-section="notificaciones">Notificaciones</a>
    <a href="#" data-section="agenda">Agenda</a>
    <a href="#" data-section="reportes">Reportes</a>
  </nav>

  <!-- Main content -->
  <main class="content">
    <!-- Usuarios -->
    <section id="usuarios" class="section">
      <h2>Gestión de Usuarios</h2>
      <p class="text-muted">Crear, editar o eliminar registros de propietarios.</p>
      <button class="btn btn-primary mb-3" onclick="openUserModal()">➕ Nuevo Usuario</button>

      <div class="table-responsive">
        <table class="table table-bordered align-middle">
          <thead>
            <tr>
              <th>ID</th><th>Nombre</th><th>Tipo</th><th>Cédula/NIT</th>
              <th>Teléfono</th><th>Email</th><th>Acciones</th>
            </tr>
          </thead>
          <tbody id="usuariosTable">
            <!-- Filas generadas por JS -->
          </tbody>
        </table>
      </div>
    </section>

    <!-- Vehículos -->
    <section id="vehiculos" class="section d-none">
      <h2>Gestión de Vehículos</h2>
      <p>Placa, marca, modelo, año, última revisión y vencimiento.</p>
      <!-- Aquí iría la tabla o formulario de vehículos -->
    </section>

    <!-- Notificaciones -->
    <section id="notificaciones" class="section d-none">
      <h2>Notificaciones Automáticas</h2>
      <p>Configura recordatorios por WhatsApp, SMS y email.</p>
    </section>

    <!-- Agenda -->
    <section id="agenda" class="section d-none">
      <h2>Agenda de Citas</h2>
      <p>Calendario interactivo con disponibilidad por día y hora.</p>
    </section>

    <!-- Reportes -->
    <section id="reportes" class="section d-none">
      <h2>Reportes</h2>
      <p>Clientes activos, revisiones vencidas, próximos vencimientos.</p>
    </section>
  </main>

  <!-- Modal Crear/Editar Usuario -->
  <div class="modal fade" id="userModal" tabindex="-1">
    <div class="modal-dialog">
      <form class="modal-content" onsubmit="saveUser(event)">
        <div class="modal-header">
          <h5 class="modal-title" id="modalTitle">Nuevo Usuario</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <input type="hidden" id="userId">
          <div class="mb-2">
            <label class="form-label">Nombre</label>
            <input type="text" id="nombre" class="form-control" required>
          </div>
          <div class="mb-2">
            <label class="form-label">Tipo Usuario</label>
            <select id="tipo" class="form-select" required>
              <option value="persona">Persona</option>
              <option value="empresa">Empresa</option>
            </select>
          </div>
          <div class="mb-2">
            <label class="form-label">Cédula/NIT</label>
            <input type="text" id="documento" class="form-control" required>
          </div>
          <div class="mb-2">
            <label class="form-label">Teléfono</label>
            <input type="text" id="telefono" class="form-control" required>
          </div>
          <div class="mb-2">
            <label class="form-label">Email</label>
            <input type="email" id="email" class="form-control" required>
          </div>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
          <button type="submit" class="btn btn-primary">Guardar</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Bootstrap JS + Popper -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // Datos simulados
    let usuarios = [
      {id:1,nombre:"Juan Pérez",tipo:"persona",doc:"123456789",tel:"3001112233",email:"juan@mail.com"},
      {id:2,nombre:"Transportes XYZ",tipo:"empresa",doc:"900123456",tel:"3205556677",email:"contacto@xyz.com"}
    ];

    const usuariosTable = document.getElementById('usuariosTable');
    const modal = new bootstrap.Modal('#userModal');

    function renderUsuarios(){
      usuariosTable.innerHTML = usuarios.map(u => `
        <tr>
          <td>${u.id}</td>
          <td>${u.nombre}</td>
          <td>${u.tipo}</td>
          <td>${u.doc}</td>
          <td>${u.tel}</td>
          <td>${u.email}</td>
          <td>
            <button class="btn btn-sm btn-warning" onclick="editUser(${u.id})">Editar</button>
            <button class="btn btn-sm btn-danger" onclick="deleteUser(${u.id})">Eliminar</button>
          </td>
        </tr>`).join('');
    }

    function openUserModal(){
      document.getElementById('modalTitle').innerText = "Nuevo Usuario";
      document.getElementById('userId').value = "";
      document.getElementById('nombre').value = "";
      document.getElementById('tipo').value = "persona";
      document.getElementById('documento').value = "";
      document.getElementById('telefono').value = "";
      document.getElementById('email').value = "";
      modal.show();
    }

    function saveUser(e){
      e.preventDefault();
      const id = document.getElementById('userId').value;
      const nuevo = {
        id: id? parseInt(id) : Date.now(),
        nombre: document.getElementById('nombre').value,
        tipo: document.getElementById('tipo').value,
        doc: document.getElementById('documento').value,
        tel: document.getElementById('telefono').value,
        email: document.getElementById('email').value
      };
      if(id){
        usuarios = usuarios.map(u=> u.id==id? nuevo : u);
      } else {
        usuarios.push(nuevo);
      }
      renderUsuarios();
      modal.hide();
    }

    function editUser(id){
      const u = usuarios.find(x=>x.id==id);
      document.getElementById('modalTitle').innerText = "Editar Usuario";
      document.getElementById('userId').value = u.id;
      document.getElementById('nombre').value = u.nombre;
      document.getElementById('tipo').value = u.tipo;
      document.getElementById('documento').value = u.doc;
      document.getElementById('telefono').value = u.tel;
      document.getElementById('email').value = u.email;
      modal.show();
    }

    function deleteUser(id){
      if(confirm("¿Eliminar este usuario?")){
        usuarios = usuarios.filter(u=>u.id!=id);
        renderUsuarios();
      }
    }

    // Navegación lateral
    document.querySelectorAll('.sidebar a').forEach(link=>{
      link.addEventListener('click', e=>{
        e.preventDefault();
        document.querySelectorAll('.sidebar a').forEach(l=>l.classList.remove('active'));
        link.classList.add('active');
        const target = link.dataset.section;
        document.querySelectorAll('.section').forEach(s=> s.classList.add('d-none'));
        document.getElementById(target).classList.remove('d-none');
      });
    });

    renderUsuarios();
  </script>
</body>
</html>
